{
  "version": 3,
  "file": "app.css",
  "sources": [
    "../App.svelte"
  ],
  "sourcesContent": [
    "<script>\n  import { onMount } from \"svelte\";\n  import { shows, user } from \"./stores.js\";\n  import { getSession, deleteSession, createAuth } from \"@tridnguyen/auth\";\n  import slugify from \"@tridnguyen/slugify\";\n\n  const showsSSId = \"1t9m4G2uujVZhq8VCrw5VQhxCjT9IVXEeV2SspyhB6cU\";\n  const auth = createAuth();\n\n  function getUserSession() {\n    const session = getSession();\n    user.set(session || {});\n  }\n\n  function login() {\n    auth.silentAuth();\n  }\n\n  function logout() {\n    deleteSession();\n    getUserSession();\n  }\n\n  auth.handleCallback((err) => {\n    if (err) {\n      console.error(err);\n      return;\n    }\n    getUserSession();\n  });\n\n  getUserSession();\n\n  function getShowFromRow(row) {\n    return {\n      title: row.cells[0],\n      slug: slugify(row.cells[0]),\n      rating: row.cells[1],\n    };\n  }\n\n  async function getShowDetails(title) {\n    const response = await fetch(\n      `${THIRDPARTY_API_URL}/omdb?type=series&title=${encodeURIComponent(\n        title\n      )}`\n    ).then((r) => r.json());\n    if (response.Response == \"False\") {\n      return;\n    }\n    return response;\n  }\n\n  onMount(async () => {\n    const resp = await fetch(`${SHEETS_API_URL}/${showsSSId}`).then((r) =>\n      r.json()\n    );\n    // first row is the title, ignore it\n    shows.update((n) =>\n      n\n        .concat(resp.sheets[0].rows.slice(1).map(getShowFromRow))\n        .sort((showA, showB) => {\n          // sort from high to low\n          return showB.rating - showA.rating;\n        })\n    );\n\n    for (const [index, show] of $shows.entries()) {\n      let details = await getShowDetails(show.title);\n      if (details) {\n        shows.update((n) => {\n          n[index].details = details;\n          return n;\n        });\n      }\n    }\n  });\n</script>\n\n<div class=\"container\">\n  <div class=\"user\">\n    {#if $user.profile}\n      <button\n        class=\"uk-button uk-button-default\"\n        type=\"button\"\n        on:click={logout}>\n        Logout\n      </button>\n    {:else}\n      <button\n        class=\"uk-button uk-button-default\"\n        type=\"button\"\n        on:click={login}>\n        Login\n      </button>\n    {/if}\n  </div>\n  <table class=\"uk-table uk-table-striped\">\n    <thead>\n      <th>Shows</th>\n      <th>Plot</th>\n      <th>Rating</th>\n    </thead>\n    <tbody>\n      {#each $shows as show}\n        <tr>\n          <td class=\"show\">\n            <a href=\"#{show.slug}\">\n              {#if show.details && show.details.Poster}\n                <img src={show.details.Poster} alt=\"Poster for {show.title}\" />\n              {/if}\n              {show.title}\n            </a>\n          </td>\n          <td class=\"plot\">\n            {#if show.details && show.details.Plot}{show.details.Plot}{/if}\n          </td>\n          <td class=\"rating\">\n            {#if show.details && show.details.Ratings && show.details.Ratings.length}\n              <div>IMDB: {show.details.Ratings[0].Value}</div>\n            {/if}\n          </td>\n        </tr>\n      {/each}\n    </tbody>\n  </table>\n</div>\n\n<style>\n  .container {\n    margin: 2em auto;\n    width: 95%;\n  }\n  .user {\n    display: none;\n  }\n  .show {\n    font-size: 1.15em;\n    min-height: 11.25rem; /* set height to prevent layout shifts when image loads */\n  }\n  .plot {\n    font-size: 0.9em;\n  }\n  .show img {\n    max-width: 7em;\n    padding-right: 1em;\n    float: left;\n    margin-bottom: 0.5em;\n  }\n  @media (min-width: 48em) {\n    .container {\n      width: 80%;\n    }\n    .show img {\n      padding-right: 2em;\n    }\n  }\n</style>\n"
  ],
  "names": [],
  "mappings": "AAiIE,UAAU,8BAAC,CAAC,AACV,MAAM,CAAE,GAAG,CAAC,IAAI,CAChB,KAAK,CAAE,GAAG,AACZ,CAAC,AACD,KAAK,8BAAC,CAAC,AACL,OAAO,CAAE,IAAI,AACf,CAAC,AACD,KAAK,8BAAC,CAAC,AACL,SAAS,CAAE,MAAM,CACjB,UAAU,CAAE,QAAQ,AACtB,CAAC,AACD,KAAK,8BAAC,CAAC,AACL,SAAS,CAAE,KAAK,AAClB,CAAC,AACD,oBAAK,CAAC,GAAG,eAAC,CAAC,AACT,SAAS,CAAE,GAAG,CACd,aAAa,CAAE,GAAG,CAClB,KAAK,CAAE,IAAI,CACX,aAAa,CAAE,KAAK,AACtB,CAAC,AACD,MAAM,AAAC,YAAY,IAAI,CAAC,AAAC,CAAC,AACxB,UAAU,8BAAC,CAAC,AACV,KAAK,CAAE,GAAG,AACZ,CAAC,AACD,oBAAK,CAAC,GAAG,eAAC,CAAC,AACT,aAAa,CAAE,GAAG,AACpB,CAAC,AACH,CAAC"
}